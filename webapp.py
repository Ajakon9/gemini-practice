import streamlit as st

# ãƒšãƒ¼ã‚¸è¨­å®šï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–åãªã©ã‚’è¨­å®šï¼‰
st.set_page_config(page_title="Medi-Support AI", layout="wide")

# --- ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ï¼‰ ---
st.sidebar.title("ğŸ¥ ãƒ¡ãƒ‹ãƒ¥ãƒ¼")
# ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã§æ©Ÿèƒ½ã‚’é¸ã¶
menu = st.sidebar.selectbox("æ©Ÿèƒ½ã‚’é¸æŠã—ã¦ãã ã•ã„", ["BMIè¨ˆç®—", "ç´¹ä»‹çŠ¶ä½œæˆï¼ˆãƒ‡ãƒ¢ï¼‰"])

# --- æ©Ÿèƒ½1: BMIè¨ˆç®— ---
if menu == "BMIè¨ˆç®—":
    st.title("âš–ï¸ BMIè¨ˆç®—ãƒ„ãƒ¼ãƒ«")
    
    # ã‚«ãƒ©ãƒ ï¼ˆåˆ—ï¼‰ã‚’ä½¿ã£ã¦ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’æ•´ãˆã‚‹ï¼ˆå·¦ã«èº«é•·ã€å³ã«ä½“é‡ï¼‰
    col1, col2 = st.columns(2)
    
    with col1:
        height = st.number_input("èº«é•· (cm)", min_value=100.0, value=170.0)
    with col2:
        weight = st.number_input("ä½“é‡ (kg)", min_value=30.0, value=60.0)

    if st.button("è¨ˆç®—ã™ã‚‹"):
        bmi = weight / ((height / 100) ** 2)
        st.metric(label="BMIã‚¹ã‚³ã‚¢", value=f"{bmi:.2f}")
        
        if bmi < 18.5:
            st.info("ç—©ã›å‹ã§ã™")
        elif bmi < 25:
            st.success("é©æ­£ä½“é‡ã§ã™")
        else:
            st.error("è‚¥æº€æ°—å‘³ã§ã™")

# --- æ©Ÿèƒ½2: ç´¹ä»‹çŠ¶ä½œæˆï¼ˆä»Šå›ã®ãƒ¡ã‚¤ãƒ³ï¼ï¼‰ ---
elif menu == "ç´¹ä»‹çŠ¶ä½œæˆï¼ˆãƒ‡ãƒ¢ï¼‰":
    st.title("ğŸ“© ç´¹ä»‹çŠ¶ è‡ªå‹•ç”Ÿæˆãƒ‡ãƒ¢")
    st.caption("æ‚£è€…æƒ…å ±ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ç´¹ä»‹çŠ¶ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’è‡ªå‹•ä½œæˆã—ã¾ã™ã€‚")

    # å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
    patient_name = st.text_input("æ‚£è€…æ°å", placeholder="ä¾‹ï¼šå¤§é˜ª å¤ªéƒ")
    age = st.number_input("å¹´é½¢", value=65, step=1)
    diagnosis = st.text_input("è¨ºæ–­å", placeholder="ä¾‹ï¼š2å‹ç³–å°¿ç—…")
    symptoms = st.text_area("ç—‡çŠ¶ãƒ»çµŒéãƒ»å‡¦æ–¹å†…å®¹", height=150, placeholder="ã“ã“ã«å…¥åŠ›ã—ãŸå†…å®¹ãŒæœ¬æ–‡ã«åæ˜ ã•ã‚Œã¾ã™ã€‚")

    # ä½œæˆãƒœã‚¿ãƒ³
    if st.button("ç´¹ä»‹çŠ¶ã‚’ä½œæˆã™ã‚‹"):
        if patient_name and diagnosis:
            # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ–‡å­—ã‚’åŸ‹ã‚è¾¼ã‚€ï¼ˆAIã®åŸºæœ¬ï¼ï¼‰
            letter_text = f"""
è¨ºç™‚æƒ…å ±æä¾›æ›¸

ç´¹ä»‹å…ˆåŒ»ç™‚æ©Ÿé–¢ å¾¡æœºä¸‹

ä¸‹è¨˜ã®æ‚£è€…æ§˜ã‚’ã”ç´¹ä»‹ç”³ã—ä¸Šã’ã¾ã™ã€‚ã”é«˜è¨ºã®ã»ã©ä½•å’ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚

ã€æ‚£è€…æ°åã€‘ {patient_name} æ®¿ ({age}æ­³)
ã€è¨ºæ–­åã€‘ {diagnosis}

ã€ç´¹ä»‹ç›®çš„ãƒ»çµŒéã€‘
{symptoms}

ã€å‚™è€ƒã€‘
æœ¬äººã®å¸Œæœ›ã«ã‚ˆã‚Šè²´é™¢ã‚’ã”ç´¹ä»‹ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚
ç¾åœ¨ã®å‡¦æ–¹å†…å®¹ã¯æ·»ä»˜ã®ãŠè–¬æ‰‹å¸³ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

ä»¥ä¸Š
--------------------------------------------------
ä½œæˆæ—¥ï¼š2025å¹´11æœˆ22æ—¥
ä½œæˆè€…ï¼šGeminiã‚¯ãƒªãƒ‹ãƒƒã‚¯ æ•‘æ€¥ç§‘
"""
            # ç”»é¢ã«è¡¨ç¤º
            st.subheader("ä½œæˆçµæœ")
            st.text_area("ã‚³ãƒ”ãƒ¼ç”¨ãƒ†ã‚­ã‚¹ãƒˆ", letter_text, height=400)
            st.success("ä½œæˆå®Œäº†ã—ã¾ã—ãŸï¼")
        else:
            st.warning("æ‚£è€…åã¨è¨ºæ–­åã¯å¿…é ˆã§ã™ã€‚")